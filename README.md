# PowerShell-Server-Audit-Script

A PowerShell script which can be copied/pasted into a PowerShell console window and retrieve auditable server configuration settings. This script only runs a series a queries (it does not make any modifications) and then creates a folder with a text and html document on the user's desktop named after the computer name which can then be zipped and uploaded to your favorite auditor :)

This script can be run on any server. Simply copy the entire blob of text below and paste into PowerShell.

New-Item -ItemType directory -Path "$($env:USERPROFILE)\Desktop\Server Audit" ; echo "SYSTEM INFORMATION:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" ; systeminfo | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; echo "ANTIVIRUS STATUS:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; Get-MpComputerStatus | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; echo "AUDIT POLICY SETTINGS:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; auditpol.exe /get /category:* | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; echo "INSTALLED UPDATES:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; wmic qfe list | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; echo "INSTALLED PROGRAMS:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; wmic product get name,version | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; echo "SHARES:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; net share | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; echo "LOCAL ADMINISTRATOR AND GUEST STATUS:" | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append ; Get-LocalUser | Out-File "$($env:USERPROFILE)\Desktop\Server Audit\$env:computername.txt" -append
